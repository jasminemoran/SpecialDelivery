"use strict";var Streamerbot=(()=>{var H=Object.defineProperty,oe=Object.defineProperties,se=Object.getOwnPropertyDescriptor,ie=Object.getOwnPropertyDescriptors,ae=Object.getOwnPropertyNames,V=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var $=(c,t,r)=>t in c?H(c,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[t]=r,W=(c,t)=>{for(var r in t||(t={}))J.call(t,r)&&$(c,r,t[r]);if(V)for(var r of V(t))ce.call(t,r)&&$(c,r,t[r]);return c},F=(c,t)=>oe(c,ie(t));var pe=(c,t)=>{for(var r in t)H(c,r,{get:t[r],enumerable:!0})},ue=(c,t,r,l)=>{if(t&&typeof t=="object"||typeof t=="function")for(let p of ae(t))!J.call(c,p)&&p!==r&&H(c,p,{get:()=>t[p],enumerable:!(l=se(t,p))||l.enumerable});return c};var le=c=>ue(H({},"__esModule",{value:!0}),c);var v=(c,t,r)=>new Promise((l,p)=>{var b=h=>{try{f(r.next(h))}catch(S){p(S)}},d=h=>{try{f(r.throw(h))}catch(S){p(S)}},f=h=>h.done?l(h.value):Promise.resolve(h.value).then(b,d);f((r=r.apply(c,t)).next())});var de={};pe(de,{Client:()=>K});var U=null;typeof WebSocket!="undefined"?U=WebSocket:typeof MozWebSocket!="undefined"?U=MozWebSocket:typeof global!="undefined"?U=global.WebSocket||global.MozWebSocket:typeof window!="undefined"?U=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(U=self.WebSocket||self.MozWebSocket);var z=U;var x={Application:["ActionAdded","ActionUpdated","ActionDeleted"],Command:["Message","Whisper","MessageCooldown","BotWhisper"],DonorDrive:["Donation","ProfileUpdated"],FileWatcher:["Changed","Created","Deleted","Renamed"],General:["Custom"],HypeRate:["HeartRatePulse"],Kofi:["Donation","Subscription","Resubscription","ShopOrder","Commission"],Midi:["Message"],Misc:["TimedAction","PyramidSuccess","PyramidBroken"],Obs:["Connected","Disconnected"],Patreon:["FollowCreated","FollowDeleted","PledgeCreated","PledgeUpdated","PledgeDeleted"],Pulsoid:["HeartRatePulse"],Quote:["Added","Show"],Raw:["Action","SubAction","ActionCompleted"],Shopify:["OrderCreated","OrderPaid"],SpeechToText:["Dictation","Command"],StreamElements:["Tip","Merch"],Streamlabs:["Donation","Merchandise"],TipeeeStream:["Donation"],TreatStream:["Treat"],Twitch:["Follow","Cheer","Sub","ReSub","GiftSub","GiftBomb","Raid","HypeTrainStart","HypeTrainUpdate","HypeTrainLevelUp","HypeTrainEnd","RewardRedemption","RewardCreated","RewardUpdated","RewardDeleted","CommunityGoalContribution","CommunityGoalEnded","StreamUpdate","Whisper","FirstWord","SubCounterRollover","BroadcastUpdate","StreamUpdateGameOnConnect","PresentViewers","PollCreated","PollUpdated","PollCompleted","PredictionCreated","PredictionUpdated","PredictionCompleted","PredictionCanceled","PredictionLocked","ChatMessage","ChatMessageDeleted","UserTimedOut","UserBanned","Announcement","AdRun","BotWhisper","CharityDonation","CharityCompleted","CoinCheer","ShoutoutCreated","UserUntimedOut","CharityStarted","CharityProgress","GoalBegin","GoalProgress","GoalEnd","ShieldModeBegin","ShieldModeEnd","AdMidRoll"],WebsocketClient:["Open","Close","Message"],WebsocketCustomServer:["Open","Close","Message"],YouTube:["BroadcastStarted","BroadcastEnded","Message","MessageDeleted","UserBanned","SuperChat","SuperSticker","NewSponsor","MemberMileStone","NewSponsorOnlyStarted","NewSponsorOnlyEnded","StatisticsUpdated","BroadcastUpdated","MembershipGift","GiftMembershipReceived","FirstWords","PresentViewers"]};(function(c,t){typeof define=="function"&&define.amd?define([],function(){return t(c)}):typeof module=="object"&&module.exports?module.exports=t(c):t(c)})(typeof self!="undefined"?self:void 0,function(c){"use strict";if(typeof Promise!="function")throw"Promise support required";var t=c.crypto||c.msCrypto;if(!t)return;var r=t.subtle||t.webkitSubtle;if(!r)return;var l=c.Crypto||t.constructor||Object,p=c.SubtleCrypto||r.constructor||Object,b=c.CryptoKey||c.Key||Object,d=c.navigator.userAgent.indexOf("Edge/")>-1,f=!!c.msCrypto&&!d,h=!t.subtle&&!!t.webkitSubtle;if(!f&&!h)return;function S(e){return btoa(e).replace(/\=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function w(e){return e+="===",e=e.slice(0,-e.length%4),atob(e.replace(/-/g,"+").replace(/_/g,"/"))}function E(e){for(var n=new Uint8Array(e.length),a=0;a<e.length;a++)n[a]=e.charCodeAt(a);return n}function R(e){return e instanceof ArrayBuffer&&(e=new Uint8Array(e)),String.fromCharCode.apply(String,e)}function C(e){var n={name:(e.name||e||"").toUpperCase().replace("V","v")};switch(n.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":e.length&&(n.length=e.length);break;case"HMAC":e.hash&&(n.hash=C(e.hash)),e.length&&(n.length=e.length);break;case"RSAES-PKCS1-v1_5":e.publicExponent&&(n.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(n.modulusLength=e.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":e.hash&&(n.hash=C(e.hash)),e.publicExponent&&(n.publicExponent=new Uint8Array(e.publicExponent)),e.modulusLength&&(n.modulusLength=e.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return n}function P(e){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[e.name][(e.hash||{}).name||e.length||""]}function T(e){(e instanceof ArrayBuffer||e instanceof Uint8Array)&&(e=JSON.parse(decodeURIComponent(escape(R(e)))));var n={kty:e.kty,alg:e.alg,ext:e.ext||e.extractable};switch(n.kty){case"oct":n.k=e.k;case"RSA":["n","e","d","p","q","dp","dq","qi","oth"].forEach(function(a){a in e&&(n[a]=e[a])});break;default:throw new TypeError("Unsupported key type")}return n}function ee(e){var n=T(e);return f&&(n.extractable=n.ext,delete n.ext),E(unescape(encodeURIComponent(JSON.stringify(n)))).buffer}function te(e){var n=j(e),a=!1;n.length>2&&(a=!0,n.shift());var o={ext:!0};switch(n[0][0]){case"1.2.840.113549.1.1.1":var m=["n","e","d","p","q","dp","dq","qi"],s=j(n[1]);a&&s.shift();for(var i=0;i<s.length;i++)s[i][0]||(s[i]=s[i].subarray(1)),o[m[i]]=S(R(s[i]));o.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return o}function re(e){var n,a=[["",null]],o=!1;switch(e.kty){case"RSA":for(var m=["n","e","d","p","q","dp","dq","qi"],s=[],i=0;i<m.length&&m[i]in e;i++){var u=s[i]=E(w(e[m[i]]));u[0]&128&&(s[i]=new Uint8Array(u.length+1),s[i].set(u,1))}s.length>2&&(o=!0,s.unshift(new Uint8Array([0]))),a[0][0]="1.2.840.113549.1.1.1",n=s;break;default:throw new TypeError("Unsupported key type")}return a.push(new Uint8Array(q(n)).buffer),o?a.unshift(new Uint8Array([0])):a[1]={tag:3,value:a[1]},new Uint8Array(q(a)).buffer}var L={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},N={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};function j(e,n){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),n||(n={pos:0,end:e.length}),n.end-n.pos<2||n.end>e.length)throw new RangeError("Malformed DER");var a=e[n.pos++],o=e[n.pos++];if(o>=128){if(o&=127,n.end-n.pos<o)throw new RangeError("Malformed DER");for(var m=0;o--;)m<<=8,m|=e[n.pos++];o=m}if(n.end-n.pos<o)throw new RangeError("Malformed DER");var s;switch(a){case 2:s=e.subarray(n.pos,n.pos+=o);break;case 3:if(e[n.pos++])throw new Error("Unsupported bit string");o--;case 4:s=new Uint8Array(e.subarray(n.pos,n.pos+=o)).buffer;break;case 5:s=null;break;case 6:var i=btoa(R(e.subarray(n.pos,n.pos+=o)));if(!(i in L))throw new Error("Unsupported OBJECT ID "+i);s=L[i];break;case 48:s=[];for(var u=n.pos+o;n.pos<u;)s.push(j(e,n));break;default:throw new Error("Unsupported DER tag 0x"+a.toString(16))}return s}function q(e,n){n||(n=[]);var a=0,o=0,m=n.length+2;if(n.push(0,0),e instanceof Uint8Array){a=2,o=e.length;for(var s=0;s<o;s++)n.push(e[s])}else if(e instanceof ArrayBuffer){a=4,o=e.byteLength,e=new Uint8Array(e);for(var s=0;s<o;s++)n.push(e[s])}else if(e===null)a=5,o=0;else if(typeof e=="string"&&e in N){var i=E(atob(N[e]));a=6,o=i.length;for(var s=0;s<o;s++)n.push(i[s])}else if(e instanceof Array){for(var s=0;s<e.length;s++)q(e[s],n);a=48,o=n.length-m}else if(typeof e=="object"&&e.tag===3&&e.value instanceof ArrayBuffer){e=new Uint8Array(e.value),a=3,o=e.byteLength,n.push(0);for(var s=0;s<o;s++)n.push(e[s]);o++}else throw new Error("Unsupported DER value "+e);if(o>=128){var u=o,o=4;for(n.splice(m,0,u>>24&255,u>>16&255,u>>8&255,u&255);o>1&&!(u>>24);)u<<=8,o--;o<4&&n.splice(m,4-o),o|=128}return n.splice(m-2,2,a,o),n}function D(e,n,a,o){Object.defineProperties(this,{_key:{value:e},type:{value:e.type,enumerable:!0},extractable:{value:a===void 0?e.extractable:a,enumerable:!0},algorithm:{value:n===void 0?e.algorithm:n,enumerable:!0},usages:{value:o===void 0?e.usages:o,enumerable:!0}})}function O(e){return e==="verify"||e==="encrypt"||e==="wrapKey"}function G(e){return e==="sign"||e==="decrypt"||e==="unwrapKey"}if(["generateKey","importKey","unwrapKey"].forEach(function(e){var n=r[e];r[e]=function(a,o,m){var s=[].slice.call(arguments),i,u,A;switch(e){case"generateKey":i=C(a),u=o,A=m;break;case"importKey":i=C(m),u=s[3],A=s[4],a==="jwk"&&(o=T(o),o.alg||(o.alg=P(i)),o.key_ops||(o.key_ops=o.kty!=="oct"?"d"in o?A.filter(G):A.filter(O):A.slice()),s[1]=ee(o));break;case"unwrapKey":i=s[4],u=s[5],A=s[6],s[2]=m._key;break}if(e==="generateKey"&&i.name==="HMAC"&&i.hash)return i.length=i.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[i.hash.name],r.importKey("raw",t.getRandomValues(new Uint8Array(i.length+7>>3)),i,u,A);if(h&&e==="generateKey"&&i.name==="RSASSA-PKCS1-v1_5"&&(!i.modulusLength||i.modulusLength>=2048))return a=C(a),a.name="RSAES-PKCS1-v1_5",delete a.hash,r.generateKey(a,!0,["encrypt","decrypt"]).then(function(y){return Promise.all([r.exportKey("jwk",y.publicKey),r.exportKey("jwk",y.privateKey)])}).then(function(y){return y[0].alg=y[1].alg=P(i),y[0].key_ops=A.filter(O),y[1].key_ops=A.filter(G),Promise.all([r.importKey("jwk",y[0],i,!0,y[0].key_ops),r.importKey("jwk",y[1],i,u,y[1].key_ops)])}).then(function(y){return{publicKey:y[0],privateKey:y[1]}});if((h||f&&(i.hash||{}).name==="SHA-1")&&e==="importKey"&&a==="jwk"&&i.name==="HMAC"&&o.kty==="oct")return r.importKey("raw",E(w(o.k)),m,s[3],s[4]);if(h&&e==="importKey"&&(a==="spki"||a==="pkcs8"))return r.importKey("jwk",te(o),m,s[3],s[4]);if(f&&e==="unwrapKey")return r.decrypt(s[3],m,o).then(function(y){return r.importKey(a,y,s[4],s[5],s[6])});var g;try{g=n.apply(r,s)}catch(y){return Promise.reject(y)}return f&&(g=new Promise(function(y,_){g.onabort=g.onerror=function(M){_(M)},g.oncomplete=function(M){y(M.target.result)}})),g=g.then(function(y){return i.name==="HMAC"&&(i.length||(i.length=8*y.algorithm.length)),i.name.search("RSA")==0&&(i.modulusLength||(i.modulusLength=(y.publicKey||y).algorithm.modulusLength),i.publicExponent||(i.publicExponent=(y.publicKey||y).algorithm.publicExponent)),y.publicKey&&y.privateKey?y={publicKey:new D(y.publicKey,i,u,A.filter(O)),privateKey:new D(y.privateKey,i,u,A.filter(G))}:y=new D(y,i,u,A),y}),g}}),["exportKey","wrapKey"].forEach(function(e){var n=r[e];r[e]=function(a,o,m){var s=[].slice.call(arguments);switch(e){case"exportKey":s[1]=o._key;break;case"wrapKey":s[1]=o._key,s[2]=m._key;break}if((h||f&&(o.algorithm.hash||{}).name==="SHA-1")&&e==="exportKey"&&a==="jwk"&&o.algorithm.name==="HMAC"&&(s[0]="raw"),h&&e==="exportKey"&&(a==="spki"||a==="pkcs8")&&(s[0]="jwk"),f&&e==="wrapKey")return r.exportKey(a,o).then(function(u){return a==="jwk"&&(u=E(unescape(encodeURIComponent(JSON.stringify(T(u)))))),r.encrypt(s[3],m,u)});var i;try{i=n.apply(r,s)}catch(u){return Promise.reject(u)}return f&&(i=new Promise(function(u,A){i.onabort=i.onerror=function(g){A(g)},i.oncomplete=function(g){u(g.target.result)}})),e==="exportKey"&&a==="jwk"&&(i=i.then(function(u){return(h||f&&(o.algorithm.hash||{}).name==="SHA-1")&&o.algorithm.name==="HMAC"?{kty:"oct",alg:P(o.algorithm),key_ops:o.usages.slice(),ext:!0,k:S(R(u))}:(u=T(u),u.alg||(u.alg=P(o.algorithm)),u.key_ops||(u.key_ops=o.type==="public"?o.usages.filter(O):o.type==="private"?o.usages.filter(G):o.usages.slice()),u)})),h&&e==="exportKey"&&(a==="spki"||a==="pkcs8")&&(i=i.then(function(u){return u=re(T(u)),u})),i}}),["encrypt","decrypt","sign","verify"].forEach(function(e){var n=r[e];r[e]=function(a,o,m,s){if(f&&(!m.byteLength||s&&!s.byteLength))throw new Error("Empy input is not allowed");var i=[].slice.call(arguments),u=C(a);if(f&&e==="decrypt"&&u.name==="AES-GCM"){var A=a.tagLength>>3;i[2]=(m.buffer||m).slice(0,m.byteLength-A),a.tag=(m.buffer||m).slice(m.byteLength-A)}i[1]=o._key;var g;try{g=n.apply(r,i)}catch(y){return Promise.reject(y)}return f&&(g=new Promise(function(y,_){g.onabort=g.onerror=function(M){_(M)},g.oncomplete=function(k){var k=k.target.result;if(e==="encrypt"&&k instanceof AesGcmEncryptResult){var B=k.ciphertext,I=k.tag;k=new Uint8Array(B.byteLength+I.byteLength),k.set(new Uint8Array(B),0),k.set(new Uint8Array(I),B.byteLength),k=k.buffer}y(k)}})),g}}),f){var ne=r.digest;r.digest=function(e,n){if(!n.byteLength)throw new Error("Empy input is not allowed");var a;try{a=ne.call(r,e,n)}catch(o){return Promise.reject(o)}return a=new Promise(function(o,m){a.onabort=a.onerror=function(s){m(s)},a.oncomplete=function(s){o(s.target.result)}}),a},c.crypto=Object.create(t,{getRandomValues:{value:function(e){return t.getRandomValues(e)}},subtle:{value:r}}),c.CryptoKey=D}h&&(t.subtle=r,c.Crypto=l,c.SubtleCrypto=p,c.CryptoKey=D)});var Q=window.crypto;function Z(){return`sb:client:req:${Date.now()}-${Q.getRandomValues(new Uint32Array(12))[0]}`}function Y(c){let t;return c.code==1e3?t="Connection closed.":c.code==1001?t='Endpoint is "going away".':c.code==1002?t="Connection closed due to a protocol error.":c.code==1003||c.code==1007||c.code==1008||c.code==1010?t="Bad request.":c.code==1004?t="Reserved":c.code==1005?t="Missing status code.":c.code==1006?t="The connection was closed abnormally.":c.code==1009?t="Message size limit exceeded.":c.code==1011?t="Server terminated connection because due to unexpected condition.":c.code==1015?t="TLS handshake failure":t="Unknown error",t}var X={host:"127.0.0.1",port:8080,endpoint:"/",immediate:!0,autoReconnect:!0,retries:-1,subscribe:{}},K=class{constructor(t=X){this.listeners=[];this.subscriptions={};this.explicitlyClosed=!1;this.retried=0;this.options=W(W({},X),t),this.options.immediate===!0&&this.connect()}connect(t=1e4){return v(this,null,function*(){yield this.disconnect(),this.explicitlyClosed=!1;let r=new AbortController,l=r.signal,p;return yield Promise.race([new Promise((b,d)=>p=setTimeout(()=>(r.abort(),d({message:"Timeout exceeded connecting to Streamer.bot WebSocket server"})),t)),new Promise((b,d)=>v(this,null,function*(){var f,h;try{this.socket=new z(`ws://${this.options.host}:${this.options.port}${this.options.endpoint}`),this.socket.addEventListener("open",()=>{console.log("Connected to Streamer.bot WebSocket server"),b()},{signal:l}),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onmessage=this.onMessage.bind(this)}catch(S){yield this.disconnect();try{(h=(f=this==null?void 0:this.options)==null?void 0:f.onError)==null||h.call(f,S)}catch(w){console.error("Error invoking onError handler",w)}d(S)}}))]).finally(()=>{clearTimeout(p),r.abort()})})}disconnect(t=1e3,r=1e4){return v(this,null,function*(){if(!this.socket||this.socket.readyState===this.socket.CLOSED)return;let l=new AbortController,p=l.signal,b;return this.explicitlyClosed=!0,yield Promise.race([new Promise((d,f)=>b=setTimeout(()=>(l.abort(),f({message:"Timeout exceeded while closing WebSocket connection"})),r)),new Promise((d,f)=>{var h,S,w;(h=this.socket)==null||h.addEventListener("close",()=>{console.log("Disconnected from Streamer.bot WebSocket server"),d()},{signal:p}),this.socket.readyState!==2&&this.socket.readyState!==3&&this.socket.close(t);try{(w=(S=this==null?void 0:this.options)==null?void 0:S.onDisconnect)==null||w.call(S)}catch(E){console.error("Error invoking onDisconnect handler",E)}})]).finally(()=>{clearTimeout(b),l.abort()})})}onOpen(){return v(this,null,function*(){var t,r,l,p;this.retried=0;try{(this.options.subscribe==="*"||Object.keys((t=this.options.subscribe)!=null?t:{}).length)&&(yield this.subscribe(this.options.subscribe)),Object.keys((r=this.subscriptions)!=null?r:{}).length&&(yield this.subscribe(this.subscriptions));let b=yield this.getInfo();(p=(l=this==null?void 0:this.options)==null?void 0:l.onConnect)==null||p.call(l,b.info)}catch(b){console.error("Error invoking onOpen handler",b)}})}onClose(t){var r,l,p;try{(t.type==="error"||!t.wasClean)&&this.options.onError&&((r=this==null?void 0:this.options)==null||r.onError(new Error(Y(t)))),(p=(l=this==null?void 0:this.options)==null?void 0:l.onDisconnect)==null||p.call(l)}catch(b){console.error("Error invoking onDisconnect handler",b)}!this.explicitlyClosed&&this.options.autoReconnect?(this.retried+=1,typeof this.options.retries=="number"&&(this.options.retries<0||this.retried<this.options.retries)?setTimeout(()=>{console.log(`Reconnecting... (attempt ${this.retried})`),this.connect()},1e3):this.cleanup()):this.cleanup()}onMessage(t){var r,l,p,b;if((t==null?void 0:t.data)&&typeof t.data=="string"){let d=JSON.parse(t.data);try{this.options.onData&&((r=this==null?void 0:this.options)==null||r.onData(d))}catch(f){console.error("Error invoking onData handler",f)}if(((l=d==null?void 0:d.event)==null?void 0:l.source)&&((p=d==null?void 0:d.event)==null?void 0:p.type)){for(let f of this.listeners)if(!!((b=f.events)!=null&&b.length)&&!!f.events.find(h=>{var S,w,E;return h===`${(S=d==null?void 0:d.event)==null?void 0:S.source}.${(w=d==null?void 0:d.event)==null?void 0:w.type}`||h.split(".",2)[1]==="*"&&h.split(".",2)[0]===((E=d==null?void 0:d.event)==null?void 0:E.source)}))try{f.callback(d)}catch(h){console.error("Error calling listener callback",f.events)}}}else console.debug("unknown message",t)}onError(t){var r,l;console.error("WebSocket Error",t);try{(l=(r=this==null?void 0:this.options)==null?void 0:r.onError)==null||l.call(r,new Error("WebSocket Error"))}catch(p){console.error("Error invoking onError handler",p)}}cleanup(){!this.socket||(this.socket.onopen=void 0,this.socket.onclose=void 0,this.socket.onerror=void 0,this.socket.onmessage=void 0,this.listeners=[],this.socket=void 0,this.retried=0)}send(t){var r;(r=this.socket)==null||r.send(JSON.stringify(t))}request(t,r="",l=5e3){return v(this,null,function*(){r||(r=Z());let p=new AbortController,b=p.signal,d;return yield Promise.race([new Promise((f,h)=>d=setTimeout(()=>(p.abort(),h({message:"WebSocket request timeout exceeded",request:t})),l)),new Promise((f,h)=>{var S;(S=this.socket)==null||S.addEventListener("message",w=>{var E,R;try{let C=JSON.parse(w==null?void 0:w.data);if((C==null?void 0:C.status)==="ok"&&(C==null?void 0:C.id)===r){let P=W({event:{source:"Request",type:(E=t.request)!=null?E:"Unknown"}},C);try{this.options.onData&&((R=this==null?void 0:this.options)==null||R.onData(P))}catch(T){console.error("Error invoking onData handler",T)}f(P)}}catch(C){h(C)}},{signal:b}),this.send(F(W({},t),{id:r}))})]).finally(()=>{clearTimeout(d),p.abort()})})}on(t,r){return v(this,null,function*(){var l,p,b;try{if(Array.isArray(t)||(t=[t]),!(t!=null&&t.length))return;let d=!1;for(let f of t){let[h,S]=(l=f.split(".",2))!=null?l:[null,null];if(!h||!S||!(h in x))continue;let w=h,E=S;if(E){d=!0;let R=new Set([...(p=this.subscriptions[w])!=null?p:[],...E==="*"?x[w]:[E]]);this.subscriptions[w]=[...R]}}d&&((b=this.socket)==null?void 0:b.readyState)===1&&(yield this.subscribe(this.subscriptions)),this.listeners.push({events:t,callback:r}),console.log("Subscribed to events",t)}catch(d){console.error("Failed adding event listener",t)}})}subscribe(t){return v(this,null,function*(){var r,l;t==="*"&&(t=x);for(let p in t){if(p===void 0||!Object.keys(x).includes(p))continue;let b=p,d=(r=t[b])!=null?r:[];if(d&&d.length){let f=new Set([...(l=this.subscriptions[b])!=null?l:[],...d]);this.subscriptions[b]=[...f]}}return yield this.request({request:"Subscribe",events:this.subscriptions})})}unsubscribe(t){return v(this,null,function*(){var r,l;t==="*"&&(t=x);for(let p in t){if(p===void 0||!Object.keys(x).includes(p))continue;let b=p,d=t[b];if(d&&d.length)for(let f of d)f&&(r=this.subscriptions[b])!=null&&r.filter&&((l=this.subscriptions[b]=this.subscriptions[b])==null||l.filter(h=>f!==h))}return yield this.request({request:"UnSubscribe",events:t})})}getEvents(){return v(this,null,function*(){return yield this.request({request:"GetEvents"})})}getActions(){return v(this,null,function*(){return yield this.request({request:"GetActions"})})}doAction(t,r){return v(this,null,function*(){let l,p;return typeof t=="string"?l=t:(l=t.id,p=t.name),yield this.request({request:"DoAction",action:{id:l,name:p},args:r})})}getBroadcaster(){return v(this,null,function*(){return yield this.request({request:"GetBroadcaster"})})}getCredits(){return v(this,null,function*(){return yield this.request({request:"GetCredits"})})}testCredits(){return v(this,null,function*(){return yield this.request({request:"TestCredits"})})}clearCredits(){return v(this,null,function*(){return yield this.request({request:"ClearCredits"})})}getInfo(){return v(this,null,function*(){return yield this.request({request:"GetInfo"})})}getActiveViewers(){return v(this,null,function*(){return yield this.request({request:"GetActiveViewers"})})}};Object.assign(globalThis,{StreamerbotClient:K});return le(de);})();
/**
 * @file Web Cryptography API shim
 * @author Artem S Vybornov <vybornov@gmail.com>
 * @license MIT
 */
